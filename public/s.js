var f,s,k,m,d,p,w,g,y;d=console;s=location.host;({protocol:g,host:s}=location);k=g+`//${s}/`;y=e=>new Promise(r=>setTimeout(r,e));w=()=>parseInt(new Date/1e3);m=async e=>{var r,a,o,n,c,t,h;if(h=new URL(e.url),h.host!==s){a={credentials:"omit",mode:"cors"};try{t=await fetch(e,a)}catch(i){o=i,delete a.mode,t=await fetch(e,a)}}else t=await fetch(e);return t&&(n=[200,301,304].includes(t.status),n&&(t.ok=n,r=t.headers.get("cache-control")||"",r!=="no-cache"&&(c=new Response(t.clone().body,t),c.headers.set("#",w().toString(36)),caches.open(1).then(i=>i.put(e,c))))),t};p=async e=>{var r,a;for(a=0;;)try{return await m(e)}catch(o){if(r=o,a++>9)throw r;d.error(a,e,r)}};f={install:e=>{e.waitUntil(skipWaiting())},activate:e=>{e.waitUntil(clients.claim())},fetch:e=>{var r,a,o,n,c;n=e.request,{url:c,method:a}=n,c.startsWith("http")&&(["GET","OPTIONS"].indexOf(a)<0||n.headers.get("accept").includes("stream")||({host:r}=c=new URL(c),{pathname:o}=c,r===s&&!o.includes(".")&&(n=new Request("/",{method:a})),e.respondWith(caches.match(n).then(async t=>{var h,i,u,l;if(t)for(h=t.headers.get("cache-control")||"";;){if(h&&(l=/max-age=(\d+)/.exec(h),l&&w-parseInt(t.headers.get("#"),36)-l[1]<0))return t;break}try{u=await p(n)}catch(v){if(i=v,t)return d.error(i),t;throw i}return t&&t.ok&&!u.ok?t:u}))))}};(()=>{var e,r;for(e in f)r=f[e],addEventListener(e,r)})()
